#!/bin/bash

host=185.222.117.80
port=6600
http_port=8000

http="http://$host:$http_port"

mpc playlist | grep $http > /dev/null || mpc add $http
#pgrep music-status > /dev/null || music-status & disown

function _mpc {
    mpc --host=$host --port=$port "$@"
}

function play {
    _mpc stop
    _mpc clear

    echo "$1" | while read track; do
        _mpc search filename "$track" | _mpc add
    done

    _mpc play

    mpc play
}

function pause {
    _mpc pause
    notify-send "Paused"
}

function resume {
    _mpc play
    notify-send "Resumed"
}

cmd=$@

if [ "$cmd" = select ]; then
    result=$(_mpc listall | prompt "Select a song")
    [ "$result" ] && play "$result"
elif [ "$cmd" = interactive ]; then
    artist=$(_mpc ls | prompt "Select an artist")
    [ "$artist" ] && album=$(_mpc ls "$artist" | prompt "Select an album")
    [ "$album" ] && track=$(_mpc ls "$album" | prompt "Select a track")
    [ "$track" ] && play "$track"
elif [ "$cmd" = toggle ]; then
    _mpc | grep playing && pause || resume
else
    _mpc "$@"
fi
